{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/anastasiapetrova/WebstormProjects/Todol/src/app/todos/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport { useRouter } from 'next/navigation';\n\ninterface Todo {\n    id: number;\n    title: string;\n    description?: string;\n    completed: boolean;\n    created_at: string;\n    updated_at: string;\n}\n\nexport default function TodosPage() {\n    const [todos, setTodos] = useState<Todo[]>([]);\n    const [newTodo, setNewTodo] = useState('');\n    const [isLoading, setIsLoading] = useState(false);\n    const [error, setError] = useState('');\n    const [token, setToken] = useState<string | null>(null);\n    const router = useRouter();\n\n    useEffect(() => {\n        const savedToken = localStorage.getItem('auth_token');\n        if (!savedToken) {\n            router.push('/login');\n            return;\n        }\n        setToken(savedToken);\n        loadTodos(savedToken);\n    }, [router]);\n\n    const loadTodos = async (authToken: string) => {\n        try {\n            const response = await fetch('http://localhost:8000/api.php/todos', {\n                headers: {\n                    'Authorization': `Bearer ${authToken}`,\n                    'Content-Type': 'application/json',\n                },\n            });\n\n            if (response.ok) {\n                const todosData = await response.json();\n                setTodos(todosData);\n                setError('');\n            } else {\n                setError(`Ошибка загрузки: HTTP ${response.status}`);\n            }\n        } catch (err: any) {\n            setError(`Ошибка загрузки: ${err.message}`);\n        }\n    };\n\n    const addTodo = async (e: React.FormEvent) => {\n        e.preventDefault();\n        if (!newTodo.trim() || !token) return;\n\n        setIsLoading(true);\n        setError('');\n        try {\n            const response = await fetch('http://localhost:8000/api.php/todos', {\n                method: 'POST',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({\n                    title: newTodo,\n                    description: '',\n                    completed: false,\n                }),\n            });\n\n            if (response.ok) {\n                setNewTodo('');\n                await loadTodos(token);\n            } else {\n                const errorData = await response.json().catch(() => ({}));\n                setError(`Ошибка создания: ${errorData.message || `HTTP ${response.status}`}`);\n            }\n        } catch (err: any) {\n            setError(`Ошибка создания: ${err.message}`);\n        } finally {\n            setIsLoading(false);\n        }\n    };\n\n    const toggleTodo = async (id: number, completed: boolean) => {\n        if (!token) return;\n        \n        try {\n            const response = await fetch(`http://localhost:8000/api.php/todos/${id}`, {\n                method: 'PUT',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    'Content-Type': 'application/json',\n                },\n                body: JSON.stringify({ completed }),\n            });\n\n            if (response.ok) {\n                await loadTodos(token);\n            }\n        } catch (err: any) {\n            setError(`Ошибка обновления: ${err.message}`);\n        }\n    };\n\n    const deleteTodo = async (id: number) => {\n        if (!token) return;\n        \n        try {\n            const response = await fetch(`http://localhost:8000/api.php/todos/${id}`, {\n                method: 'DELETE',\n                headers: {\n                    'Authorization': `Bearer ${token}`,\n                    'Content-Type': 'application/json',\n                },\n            });\n\n            if (response.ok) {\n                await loadTodos(token);\n            }\n        } catch (err: any) {\n            setError(`Ошибка удаления: ${err.message}`);\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('auth_token');\n        localStorage.removeItem('user');\n        router.push('/login');\n    };\n\n    return (\n        <div className=\"min-h-screen bg-gradient-to-br from-slate-900 to-black text-white\">\n            <div className=\"container mx-auto px-4 py-8\">\n                <div className=\"max-w-2xl mx-auto\">\n                    <h1 className=\"text-4xl font-bold text-center mb-8 bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent\">\n                        Мои задачи\n                    </h1>\n\n                    {error && (\n                        <div className=\"bg-red-500/20 border border-red-500/30 rounded-lg p-3 mb-6 text-red-400 text-sm\">\n                            {error}\n                        </div>\n                    )}\n\n                    <form onSubmit={addTodo} className=\"mb-8\">\n                        <div className=\"flex gap-2\">\n                            <input\n                                type=\"text\"\n                                value={newTodo}\n                                onChange={(e) => setNewTodo(e.target.value)}\n                                placeholder=\"Новая задача...\"\n                                className=\"flex-1 px-4 py-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                            />\n                            <button\n                                type=\"submit\"\n                                disabled={isLoading || !newTodo.trim()}\n                                className=\"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed\"\n                            >\n                                {isLoading ? 'Добавление...' : 'Добавить'}\n                            </button>\n                        </div>\n                    </form>\n\n                    <div className=\"space-y-3\">\n                        {todos.map((todo) => (\n                            <div\n                                key={todo.id}\n                                className=\"bg-white/10 backdrop-blur-lg rounded-lg p-4 border border-white/20 flex items-center gap-4\"\n                            >\n                                <input\n                                    type=\"checkbox\"\n                                    checked={todo.completed}\n                                    onChange={(e) => toggleTodo(todo.id, e.target.checked)}\n                                    className=\"w-5 h-5 rounded border-gray-300 text-blue-500 focus:ring-blue-500\"\n                                />\n                                <div className=\"flex-1\">\n                                    <h3 className={`font-medium ${todo.completed ? 'line-through text-gray-400' : 'text-white'}`}>\n                                        {todo.title}\n                                    </h3>\n                                    {todo.description && (\n                                        <p className=\"text-gray-400 text-sm mt-1\">{todo.description}</p>\n                                    )}\n                                </div>\n                                <button\n                                    onClick={() => deleteTodo(todo.id)}\n                                    className=\"px-3 py-1 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors\"\n                                >\n                                    Удалить\n                                </button>\n                            </div>\n                        ))}\n\n                        {todos.length === 0 && (\n                            <div className=\"text-center py-12\">\n                                <p className=\"text-gray-400\">Нет задач. Создайте свою первую задачу!</p>\n                            </div>\n                        )}\n                    </div>\n\n                    <div className=\"mt-8 text-center\">\n                        <button\n                            onClick={logout}\n                            className=\"px-6 py-2 bg-white/10 text-white rounded-lg hover:bg-white/20 transition-colors\"\n                        >\n                            Выйти\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}